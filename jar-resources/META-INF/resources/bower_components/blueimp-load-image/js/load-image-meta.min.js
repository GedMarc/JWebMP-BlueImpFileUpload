(function(a){if(typeof define==="function"&&define.amd){define(["./load-image"],a)}else{if(typeof module==="object"&&module.exports){a(require("./load-image"))}else{a(window.loadImage)}}})(function(c){var a=typeof Blob!=="undefined"&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice);c.blobSlice=a&&function(){var d=this.slice||this.webkitSlice||this.mozSlice;return d.apply(this,arguments)};c.metaDataParsers={jpeg:{65505:[],65517:[]}};c.parseMetaData=function(e,j,d,h){d=d||{};h=h||{};var g=this;var i=d.maxMetaDataSize||262144;var f=!(typeof DataView!=="undefined"&&e&&e.size>=12&&e.type==="image/jpeg"&&c.blobSlice);if(f||!c.readFile(c.blobSlice.call(e,0,i),function(r){if(r.target.error){console.log(r.target.error);j(h);return}var o=r.target.result;var s=new DataView(o);var m=2;var l=s.byteLength-4;var q=m;var k;var n;var t;var p;if(s.getUint16(0)===65496){while(m<l){k=s.getUint16(m);if((k>=65504&&k<=65519)||k===65534){n=s.getUint16(m+2)+2;if(m+n>s.byteLength){console.log("Invalid meta data: Invalid segment size.");break}t=c.metaDataParsers.jpeg[k];if(t){for(p=0;p<t.length;p+=1){t[p].call(g,s,m,n,h,d)}}m+=n;q=m}else{break}}if(!d.disableImageHead&&q>6){if(o.slice){h.imageHead=o.slice(0,q)}else{h.imageHead=new Uint8Array(o).subarray(0,q)}}}else{console.log("Invalid JPEG file: Missing JPEG marker.")}j(h)},"readAsArrayBuffer")){j(h)}};c.hasMetaOption=function(d){return d&&d.meta};var b=c.transform;c.transform=function(d,e,h,f,g){if(c.hasMetaOption(e)){c.parseMetaData(f,function(i){b.call(c,d,e,h,f,i)},e,g)}else{b.apply(c,arguments)}}});